---
import { z } from "astro:content";
import { PrimaryNav } from "../components/TopNav/PrimaryNav";
import { SecondaryNav } from "../components/TopNav/SecondaryNav";
import Skeleton from "./Skeleton.astro";

interface Frontmatter {
  title: string;
  description: string;
  service: string;
  activeSection?: string | null;
  ogImage?: string;
  ogType?: string;
}

interface Props {
  frontmatter?: Frontmatter;
  title?: string;
  description?: string;
  service?: string;
  activeSection?: string | null;
  ogImage?: string;
  ogType?: string;
}

const schema = z.object({
  title: z.string(),
  description: z.string(),
  service: z.string(),
  activeSection: z.string().nullable().optional(),
  ogImage: z.string().optional(),
  ogType: z.string().optional(),
});

const {
  title,
  description,
  service,
  activeSection = null,
  ogImage,
  ogType,
} = schema.parse(Astro.props.frontmatter ?? Astro.props);

// Import the article styles from the Page layout
const articleClasses = [
  "mx-auto",
  "max-w-5xl",
  "pt-8",
  "sm:pt-16",
  "pb-12",
  "sm:pb-16",
  "px-4",
  "sm:px-6",
  "prose",
  "prose-h1:text-4xl",
  "text-sm",
  "sm:text-sm",
  "leading-normal",
  "font-['Noto_Sans']",
  "font-normal",
  "text-neutral-300",
  "prose-headings:text-white",
  "prose-headings:!font-[Noto_Sans]",
  "prose-headings:!font-semibold",
  "prose-h1:mb-4",
  "prose-h2:text-3xl",
  "prose-h2:mt-10",
  "prose-h2:mb-4",
  "prose-h3:text-2xl",
  "prose-h3:mt-8",
  "prose-h3:mb-2",
  "prose-h4:text-xl",
  "prose-h4:mt-5",
  "prose-h4:mb-2",
  "prose-code:text-white",
  "prose-a:text-green-300",
  "prose-a:no-underline",
  "prose-a:[&:hover]:text-green-200",
  "prose-a:hover:underline",
  "[&_:not(pre)>code]:bg-neutral-800",
  "[&_:not(pre)>code]:py-0.5",
  "[&_:not(pre)>code]:px-1",
  "[&_:not(pre)>code]:border",
  "[&_:not(pre)>code]:border-neutral-700",
  "[&_:not(pre)>code]:rounded-sm",
  "[&_:not(pre)>code]:text-xs",
  "[&_:not(pre)>code]:font-mono",
  "[&_:not(pre)>code]:break-words",
  "[&_:not(pre)>code]:whitespace-normal",
  "prose-code:font-normal",
  "[&_code]:before:content-['']",
  "[&_code]:after:content-['']",
  "[&_code>a]:text-green-300",
  "[&_code>a]:no-underline",
  "[&_code>a]:hover:text-green-200",
  "[&_code>a]:hover:underline",
  "[&_a>code]:text-green-300",
  "[&_a>code]:hover:text-green-200",
  "prose-strong:text-white",
  "prose-strong:font-bold",
  "prose-dt:text-white",
  "prose-dl:text-neutral-400",
  "prose-ol:marker:text-white",
  "prose-ul:marker:text-white",
  "[&_dt]:text-white",
  "prose-img:max-w-full",
  "prose-img:mx-auto",
];
---

<Skeleton title={title} description={description} ogImage={ogImage} ogType={ogType}>
  <PrimaryNav client:load />
  <SecondaryNav client:load activeSection={activeSection} currentService={service} />
  <main>
    <article class={articleClasses.join(" ")}>
      <slot />
    </article>
  </main>
</Skeleton>
